#!/usr/bin/env bash
set -e

[[ "$*" == "-h" ]] && cat "${0}" && exit 0

for pr in ${*:-$(get_pr "Enter PR URLs to push an empty commit to:")}; do
	clear
	cd "$(mktemp -d)"
	echo "Pushing empty commit to PR: ${pr}"
	eval "$(gh pr view "${pr}" --json headRepository,headRepositoryOwner,headRefName -q '"gh clone \(.headRepositoryOwner.login)/\(.headRepository.name) . -- --single-branch --branch \(.headRefName)"')"
	git commit --allow-empty -m 'chore: push empty commit to trigger ci'
	git push
done
